<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./home-dash.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@200&display=swap"
      rel="stylesheet"
    />
    <title>Inicio Dashboard</title>
  </head>
  <body onload="notificar()">
    <audio id="notifyAudio" src="../assets/img_dash/notify.mp3" type="audio/mpeg"></audio>
    <div class="main-dash">
      <div class="main-rigth">
        <div class="lateral">
          <h2>Alerta ultrapassada</h2>
          <div class="cards">
            <div class="lateral-card">
              <span>Nome do totem</span>
              <span>Mémoria: </span>
              <span>CPU: </span>
              <span>Ram: </span>
              <span>Disco: </span>
            </div>
            <div class="lateral-card">
              <span>Nome do totem</span>
              <span>Mémoria: </span>
              <span>CPU: </span>
              <span>Ram: </span>
              <span>Disco: </span>
            </div>
            <div class="lateral-card">
              <span>Nome do totem</span>
              <span>Mémoria: </span>
              <span>CPU: </span>
              <span>Ram: </span>
              <span>Disco: </span>
            </div>
            <div class="lateral-card">
              <span>Nome do totem</span>
              <span>Mémoria: </span>
              <span>CPU: </span>
              <span>Ram: </span>
              <span>Disco: </span>
            </div>
          </div>
        </div>
      </div>

      <div class="main-left">
        <div class="perfil">
          <div class="perfil-usuario">
            <div class="perfil-name">sou o nome do usuario</div>
          </div>
          <div class="perfil-notificacao">
            <img src="../assets/img_dash/msg.png" alt="" />
            <img src="../assets/img_dash/carta.png" alt="" />
            <img src="../assets/img_dash/sino.png" onclick="Modalnotificacao.openNotificar(), notNotify()"  alt="" />
            <img style="display: none" id="bolinha" src="../assets/bolinha-vermelha.png" alt="" />
            
            <div class="modal">
              <div class="modal-tecnologias">
                <div>
                  <img class="exit-modal" onclick="Modalnotificacao.closeNotificar()" src="../assets/Exit.png">
                  <div style="color: #ffffff" id="aparece">Novas estréias em breve.</div>
                </div>
              </div>
          </div>
          </div>
        </div>
  
        <div class="select-totem">
          <div class="alinhar-top">
            <div class="totem-um">
              <span>Totem um</span>
              <img src="../assets/maquina-atm.png" alt="">
            </div>
            <div class="totem-dois">
              <span>totem dois</span>
              <img src="../assets/maquina-atm.png" alt="">
            </div>
          </div>
          <div class="alinha-bottom">
            <div class="totem-tres">
              <span>totem tres</span>
              <img src="../assets/maquina-atm.png" alt="">
            </div>
            <div class="totem-quatro">
              <span>totem quatro</span>
              <img src="../assets/maquina-atm.png" alt="">
            </div>
          </div>
        </div>
      </div>

     <script src="./home-dashboard.js"></script>
    </div>
  </body>
</html>
<script>

  const Modalnotificacao = {
      
    openNotificar()
    {
        document
            .querySelector('.modal')
            .classList
            .add('active')
            

    },
    closeNotificar()
    {
        document
            .querySelector('.modal')
            .classList
            .remove('active')
    }
}

      function notificar() {

fetch("/usuarios/notificar", {
    method: "GET",
}).then(function (resposta) {


    resposta.json().then(function (data) {

        let len = data.length;
        let encontreiNotificacao = false;

     
        for (let i = 0; i <= len; i++) {
            let arquivo = data[i];

          
                encontreiNotificacao = true;
                aparece.innerHTML += (`<span style="color: #2F1538;">ID:</span> ${arquivo.idLancamento},
            <span style="color: #2F1538;">Nome:</span> ${arquivo.nomeFilme}, 
            <span style="color: #2F1538;">Lançamento em: :</span> ${arquivo.dataFilme},
            <span style="color: #9d48ce;">faltam apenas:</span> ${arquivo.dias_para_lancamento} <br>`);
            document.getElementById("bolinha").style.display = "block";
            startAudioNotify()
           
            console.log("arq", arquivo)
            
        }
        if (encontreiNotificacao == false) {
         
                    //alert("Nenhum funcionario encontrado! :(");
        } 
        
    });
}).catch(function (error) {
    console.error(`ERROR`, error);
});

}


var notifyStart = document.getElementById('notifyAudio')
function startAudioNotify(){
    notifyStart.currentTime = 0.6
    notifyStart.play()
    console.log("oiaosi")
   
}

function notNotify(){
  document.getElementById("bolinha").style.display = "none";
}
</script>